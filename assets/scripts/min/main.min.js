var app=angular.module("app",["ui.router","angles"]),new_win={frame:!0,icon:"./assets/img/logo_hat.png",toolbar:!1,width:800,height:500,min_width:800,min_height:500,max_width:800,max_height:500,focus:!0,show:!1},pages=[{name:"znamky",title:"Známky",show:!0},{name:"rozvrh",title:"Rozvrh",show:!0},{name:"suplovani",title:"Suplování",show:!0},{name:"plan",title:"Plán akcí",show:!0},{name:"predmety",title:"Předměty",show:!0},{name:"vyuka",title:"Výuka",show:!0},{name:"absence",title:"Absence",show:!0},{name:"ukoly",title:"Domácí úkoly",show:!0},{name:"options",title:"Nastavení",show:!1}];app.config(["$urlRouterProvider","$stateProvider","$httpProvider","$compileProvider",function(e,t,n,o){pages.forEach(function(e){t.state(e.name,{url:"/"+e.name,templateUrl:"assets/templates/"+e.name+".html",controller:e.name+"Ctrl"})}),n.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8";var r=function(e){var t,n,o,i,a,s,l,c="";for(t in e)if(n=e[t],n instanceof Array)for(l=0;l<n.length;++l)a=n[l],o=t+"["+l+"]",s={},s[o]=a,c+=r(s)+"&";else if(n instanceof Object)for(i in n)a=n[i],o=t+"["+i+"]",s={},s[o]=a,c+=r(s)+"&";else void 0!==n&&null!==n&&(c+=encodeURIComponent(t)+"="+encodeURIComponent(n)+"&");return c.length?c.substr(0,c.length-1):c};n.defaults.transformRequest=[function(e){return angular.isObject(e)&&"[object File]"!==String(e)?r(e):e}],o.imgSrcSanitizationWhitelist(/^\s*(https?|ftp|mailto|app):/)}]),app.run(["$rootScope","$q","Users","Window","Progress",function(e,t,n,o,r){o.getWindow().hide(),e.$on("$stateChangeStart",function(){"undefined"!=typeof e.canceler&&e.canceler.resolve(),"undefined"!=typeof e.reload_listener&&e.reload_listener(),e.canceler=t.defer(),r.showLoading()}),"win32"===process.platform&&parseFloat(require("os").release(),10)>6.1&&o.getWindow().setMaximumSize(screen.availWidth+15,screen.availHeight+14),n.getUsers().then(function(t){if(t.length<=0)o.getWindow().hide(),o.listen("closed",function(){n.getUsers().then(function(t){t.length<=0?o.getWindow().close(!0):n.getFirstID().then(function(t){n.setCurrentUser(t.min),e.$emit("reload",{user:!0}),o.getWindow().show()})})},o.getWindow("newuser.html",new_win));else{var r=function(){n.getFirstID().then(function(t){localStorage.currentUser=t.min,e.$emit("reload",{user:!0})})};localStorage.currentUser?n.getUser(localStorage.currentUser).then(function(e){null==e&&r(),o.getWindow().show()}):(r(),o.getWindow().show())}})}]),app.filter("range",function(){return function(e){var t,n;switch(e.length){case 1:t=0,n=parseInt(e[0])-1;break;case 2:t=parseInt(e[0]),n=parseInt(e[1]);break;default:return e}for(var o=[],r=t;n>=r;r++)o.push(r);return o}}),app.directive("ngRightClick",function(e){return function(t,n,o){var r=e(o.ngRightClick);n.bind("contextmenu",function(e){t.$apply(function(){e.preventDefault(),r(t,{$event:e})})})}});